' Gambas module file

Private Contenido As Result

Public Sub ObtenerIdNuevoBibtex()

  ' Verificar si hay un proyecto activo
  If Trim(FMain.txtProyecto.Text) = "" Then
    Message.Info("No hay un proyecto en curso. Por favor, abra o cree un proyecto antes de continuar.")
    Return
  Endif

  ' Solo si hay proyecto se ejecuta lo siguiente:
  Dim Idn As Integer
  Dim MaxId As Variant

  MaxId = m_OnOff_y_Red.meConn.Exec("SELECT MAX(id) FROM bibtex LIMIT 1")

  If MaxId["MAX(id)"] = Null Then
    Idn = 0
  Else
    Idn = CInt(MaxId["MAX(id)"]) + 1
  Endif

  FMain.idBibtex.Text = Idn

End

Public Sub ConfigurarTableViewBibtexEnCurso(grid As GridView)

  With grid
    .Header = True
    .Grid = True
    .Columns.Count = 110

    ' Configuración de columnas
    For i As Integer = 0 To 109
      Select Case i
        Case 2
          .Columns[i].Title = "Autor"
          .Columns[i].Width = 250
        Case 3
          .Columns[i].Title = "Título"
          .Columns[i].Width = 350
        Case 50
          .Columns[i].Title = "Año"
          .Columns[i].Width = 100
        Case 52
          .Columns[i].Title = "Fecha"
          .Columns[i].Width = 100
        Case Else
          .Columns[i].Title = ""
          .Columns[i].Width = 0
      End Select
    Next
  End With

End

Public Sub RefrescarTableViewBibtexEnCurso()

  FMain.gvReferenciasEnCurso.Clear
  Contenido = m_OnOff_y_Red.meConn.Exec("SELECT * FROM bibtex WHERE id_revistas = &1", FMain.idMetadatoRevista.Text)
  FMain.gvReferenciasEnCurso.Rows.Count = Contenido.Count
  FMain.gvReferenciasEnCurso.Refresh

End

Public Sub GuardarBibtexPrimeraVez()

  Contenido = m_OnOff_y_Red.meConn.Create("bibtex")

  GuardarCamposBib()
  Contenido.Update
  m_OnOff_y_Red.meConn.Commit()
  RefrescarTableViewBibtexEnCurso()
  LimpiarCamposBIB()
  Message.Info("Cambios guardados correctamente.")

Catch
  Message.Error("Error al guardar cambios: " & Error.Text)

End

Public Sub GuardarCambiosEnBibtex()

  Contenido = m_OnOff_y_Red.meConn.Edit("bibtex", "id=" & FMain.idBibtex.Text)

  GuardarCamposBib()
  Contenido.Update
  m_OnOff_y_Red.meConn.Commit()
  RefrescarTableViewBibtexEnCurso()
  LimpiarCamposBIB()
  Message.Info("Los cambios se guardaron con éxito.")

End

Public Sub GuardarCamposBib()

  Contenido!id = FMain.idBibtex.Text
  Contenido!id_revistas = FMain.idMetadatoRevista.Text
  Contenido!txtAuthor = FMain.txtAuthor.Text
  Contenido!txtTitle = FMain.txtTitle.Text
  Contenido!cmbTipoCSL = FMain.cmbTipoCSL.Text
  Contenido!txtClaveBibtex = FMain.txtClaveBibtex.Text
  Contenido!cmbTipoDeEntrada = FMain.cmbTipoDeEntrada.Text
  Contenido!txtNameAddOn = FMain.txtNameAddOn.Text
  Contenido!txtBookAuthor = FMain.txtBookAuthor.Text
  Contenido!txtEditor = FMain.txtEditor.Text
  Contenido!txtEditorA = FMain.txtEditorA.Text
  Contenido!txtEditorB = FMain.txtEditorB.Text
  Contenido!txtEditorC = FMain.txtEditorC.Text
  Contenido!txtAfterword = FMain.txtAfterword.Text
  Contenido!txtForeword = FMain.txtForeword.Text
  Contenido!txtCommentator = FMain.txtCommentator.Text
  Contenido!txtIntroduction = FMain.txtIntroduction.Text
  Contenido!txtTranslator = FMain.txtTranslator.Text
  Contenido!txtAnnotator = FMain.txtAnnotator.Text
  Contenido!txtHolder = FMain.txtHolder.Text
  Contenido!txtGender = FMain.txtGender.Text
  Contenido!txtShortAuthor = FMain.txtShortAuthor.Text
  Contenido!cmbEditorType = FMain.cmbEditorType.Text
  Contenido!cmbEditorTypeA = FMain.cmbEditorTypeA.Text
  Contenido!cmbEditorTypeB = FMain.cmbEditorTypeB.Text
  Contenido!cmbEditorTypeC = FMain.cmbEditorTypeC.Text
  Contenido!txtTitleAddOn = FMain.txtTitleAddOn.Text
  Contenido!txtSubTitle = FMain.txtSubTitle.Text
  Contenido!txtSeries = FMain.txtSeries.Text
  Contenido!txtBookTitle = FMain.txtBookTitle.Text
  Contenido!txtBookTitleAddOn = FMain.txtBookTitleAddOn.Text
  Contenido!txtMainTitle = FMain.txtMainTitle.Text
  Contenido!txtMainTitleAddOn = FMain.txtMainTitleAddOn.Text
  Contenido!txtJournalTitle = FMain.txtJournalTitle.Text
  Contenido!txtJournalTitleAddOn = FMain.txtJournalTitleAddOn.Text
  Contenido!txtIssueTitle = FMain.txtIssueTitle.Text
  Contenido!txtIssueTitleAddOn = FMain.txtIssueTitleAddOn.Text
  Contenido!txtEventTitle = FMain.txtEventTitle.Text
  Contenido!txtEventTitleAddOn = FMain.txtEventTitleAddOn.Text
  Contenido!txtIndexTitle = FMain.txtIndexTitle.Text
  Contenido!txtShortTitle = FMain.txtShortTitle.Text
  Contenido!txtReprintTitle = FMain.txtReprintTitle.Text
  Contenido!txtVolume = FMain.txtVolume.Text
  Contenido!txtVolumes = FMain.txtVolumes.Text
  Contenido!txtNumber = FMain.txtNumber.Text
  Contenido!txtChapter = FMain.txtChapter.Text
  Contenido!txtEid = FMain.txtEid.Text
  Contenido!txtPart = FMain.txtPart.Text
  Contenido!txtEdition = FMain.txtEdition.Text
  Contenido!txtIssue = FMain.txtIssue.Text
  Contenido!txtYear = FMain.txtYear.Text
  Contenido!txtEventDate = FMain.txtEventDate.Text
  Contenido!txtDate = FMain.txtDate.Text
  Contenido!txtOrigDate = FMain.txtOrigDate.Text
  Contenido!txtUrlDate = FMain.txtUrlDate.Text
  Contenido!txtVersion = FMain.txtVersion.Text
  Contenido!cmbHyphenation = FMain.cmbHyphenation.Text
  Contenido!cmbLanguage = FMain.cmbLanguage.Text
  Contenido!cmbOrigLanguage = FMain.cmbOrigLanguage.Text
  Contenido!cmbLangId = FMain.cmbLangId.Text
  Contenido!txtLandIdOpts = FMain.txtLandIdOpts.Text
  Contenido!cmbPubState = FMain.cmbPubState.Text
  Contenido!txtPages = FMain.txtPages.Text
  Contenido!txtPageTotal = FMain.txtPageTotal.Text
  Contenido!cmbPagination = FMain.cmbPagination.Text
  Contenido!cmbBookPagination = FMain.cmbBookPagination.Text
  Contenido!txtLocation = FMain.txtLocation.Text
  Contenido!txtOrigLocation = FMain.txtOrigLocation.Text
  Contenido!txtInstitution = FMain.txtInstitution.Text
  Contenido!txtOrganization = FMain.txtOrganization.Text
  Contenido!txtPublisher = FMain.txtPublisher.Text
  Contenido!txtOrigPublisher = FMain.txtOrigPublisher.Text
  Contenido!txtVenue = FMain.txtVenue.Text
  Contenido!txtEprint = FMain.txtEprint.Text
  Contenido!cmbEprintType = FMain.cmbEprintType.Text
  Contenido!txtUrl = FMain.txtUrl.Text
  Contenido!txtIsbn = FMain.txtIsbn.Text
  Contenido!txtIssn = FMain.txtIssn.Text
  Contenido!txtIsmn = FMain.txtIsmn.Text
  Contenido!txtIsrn = FMain.txtIsrn.Text
  Contenido!txtIsan = FMain.txtIsan.Text
  Contenido!txtIswc = FMain.txtIswc.Text
  Contenido!txtDoi = FMain.txtDoi.Text
  Contenido!cmbRelatedType = FMain.cmbRelatedType.Text
  Contenido!txtRelated = FMain.txtRelated.Text
  Contenido!txtRelatedString = FMain.txtRelatedString.Text
  Contenido!txtAddendum = FMain.txtAddendum.Text
  Contenido!txtEntrySubType = FMain.txtEntrySubType.Text
  Contenido!txtOptions = FMain.txtOptions.Text
  Contenido!txtLabel = FMain.txtLabel.Text
  Contenido!txtHowPublished = FMain.txtHowPublished.Text
  Contenido!txtShortHand = FMain.txtShortHand.Text
  Contenido!txtShortHandIntro = FMain.txtShortHandIntro.Text
  Contenido!txtIds = FMain.txtIds.Text
  Contenido!txtEntrySet = FMain.txtEntrySet.Text
  Contenido!txtCrossRef = FMain.txtCrossRef.Text
  Contenido!txtXref = FMain.txtXref.Text
  Contenido!txtXdata = FMain.txtXdata.Text
  Contenido!txtPreSort = FMain.txtPreSort.Text
  Contenido!txtSortKey = FMain.txtSortKey.Text
  Contenido!txtSortName = FMain.txtSortName.Text
  Contenido!txtSortHand = FMain.txtSortHand.Text
  Contenido!txtSortYear = FMain.txtSortYear.Text
  Contenido!txtSortTitle = FMain.txtSortTitle.Text
  Contenido!txtIndexSortTitle = FMain.txtIndexSortTitle.Text
  Contenido!txtAbstract = FMain.txtAbstract.Text
  Contenido!txtNote = FMain.txtNote.Text
  Contenido!txtLibrary = FMain.txtLibrary.Text
  Contenido!txtAnnotation = FMain.txtAnnotation.Text
  Contenido!txtFile = FMain.txtFile.Text

End

Public Sub RellenarComboBoxBibTeX()

  FMain.cmbTipoDeEntrada.Add("")
  FMain.cmbTipoDeEntrada.Add("article")
  FMain.cmbTipoDeEntrada.Add("incollection")
  FMain.cmbTipoDeEntrada.Add("book")
  FMain.cmbTipoDeEntrada.Add("thesis")
  FMain.cmbTipoDeEntrada.Add("online")
  FMain.cmbTipoDeEntrada.Add("inproceedings")
  FMain.cmbTipoDeEntrada.Add("mvbook")
  FMain.cmbTipoDeEntrada.Add("inbook")
  FMain.cmbTipoDeEntrada.Add("bookinbook")
  FMain.cmbTipoDeEntrada.Add("suppbook")
  FMain.cmbTipoDeEntrada.Add("booklet")
  FMain.cmbTipoDeEntrada.Add("collection")
  FMain.cmbTipoDeEntrada.Add("mvcollection")
  FMain.cmbTipoDeEntrada.Add("suppcollection")
  FMain.cmbTipoDeEntrada.Add("manual")
  FMain.cmbTipoDeEntrada.Add("misc")
  FMain.cmbTipoDeEntrada.Add("patent")
  FMain.cmbTipoDeEntrada.Add("periodical")
  FMain.cmbTipoDeEntrada.Add("suppperiodical")
  FMain.cmbTipoDeEntrada.Add("proceedings")
  FMain.cmbTipoDeEntrada.Add("mvproceedings")
  FMain.cmbTipoDeEntrada.Add("reference")
  FMain.cmbTipoDeEntrada.Add("mvreference")
  FMain.cmbTipoDeEntrada.Add("inreference")
  FMain.cmbTipoDeEntrada.Add("report")
  FMain.cmbTipoDeEntrada.Add("set")
  FMain.cmbTipoDeEntrada.Add("unpublished")
  FMain.cmbTipoDeEntrada.Add("xdata")
  FMain.cmbTipoDeEntrada.Add("movie")
  FMain.cmbTipoDeEntrada.Add("conference")
  FMain.cmbTipoDeEntrada.Add("software")

  FMain.cmbHyphenation.Add("")' babel
  FMain.cmbHyphenation.Add("spanish")
  FMain.cmbHyphenation.Add("portuguese")
  FMain.cmbHyphenation.Add("english")
  FMain.cmbHyphenation.Add("french")
  FMain.cmbHyphenation.Add("american")
  FMain.cmbHyphenation.Add("british")
  FMain.cmbHyphenation.Add("afrikaans")
  FMain.cmbHyphenation.Add("albanian")
  FMain.cmbHyphenation.Add("arabic")
  FMain.cmbHyphenation.Add("armenian")
  FMain.cmbHyphenation.Add("austrian")
  FMain.cmbHyphenation.Add("bahasa")
  FMain.cmbHyphenation.Add("basque")
  FMain.cmbHyphenation.Add("breton")
  FMain.cmbHyphenation.Add("bulgarian")
  FMain.cmbHyphenation.Add("catalan")
  FMain.cmbHyphenation.Add("croatian")
  FMain.cmbHyphenation.Add("czech")
  FMain.cmbHyphenation.Add("danish")
  FMain.cmbHyphenation.Add("dutch")
  FMain.cmbHyphenation.Add("esperanto")
  FMain.cmbHyphenation.Add("estonian")
  FMain.cmbHyphenation.Add("finnish")
  FMain.cmbHyphenation.Add("galician")
  FMain.cmbHyphenation.Add("german")
  FMain.cmbHyphenation.Add("greek")
  FMain.cmbHyphenation.Add("hebrew")
  FMain.cmbHyphenation.Add("hungarian")
  FMain.cmbHyphenation.Add("icelandic")
  FMain.cmbHyphenation.Add("interlingua")
  FMain.cmbHyphenation.Add("irish")
  FMain.cmbHyphenation.Add("italian")
  FMain.cmbHyphenation.Add("latin")
  FMain.cmbHyphenation.Add("latvian")
  FMain.cmbHyphenation.Add("lithuanian")
  FMain.cmbHyphenation.Add("lowersorbian")
  FMain.cmbHyphenation.Add("magyar")
  FMain.cmbHyphenation.Add("naustrian")
  FMain.cmbHyphenation.Add("ngerman")
  FMain.cmbHyphenation.Add("norsk")
  FMain.cmbHyphenation.Add("nynorsk")
  FMain.cmbHyphenation.Add("polish")
  FMain.cmbHyphenation.Add("romanian")
  FMain.cmbHyphenation.Add("russian")
  FMain.cmbHyphenation.Add("scottish")
  FMain.cmbHyphenation.Add("serbian")
  FMain.cmbHyphenation.Add("slovak")
  FMain.cmbHyphenation.Add("slovene")
  FMain.cmbHyphenation.Add("swedish")
  FMain.cmbHyphenation.Add("turkish")
  FMain.cmbHyphenation.Add("ukrainian")
  FMain.cmbHyphenation.Add("uppersorbian")
  FMain.cmbHyphenation.Add("welsh")

  FMain.cmbLanguage.Add("")
  FMain.cmbLanguage.Add("spanish")
  FMain.cmbLanguage.Add("portuguese")
  FMain.cmbLanguage.Add("english")
  FMain.cmbLanguage.Add("french")
  FMain.cmbLanguage.Add("afrikaans")
  FMain.cmbLanguage.Add("albanian")
  FMain.cmbLanguage.Add("amharic")
  FMain.cmbLanguage.Add("arabic")
  FMain.cmbLanguage.Add("armenian")
  FMain.cmbLanguage.Add("asturian")
  FMain.cmbLanguage.Add("bahasai")
  FMain.cmbLanguage.Add("bahasam")
  FMain.cmbLanguage.Add("basque")
  FMain.cmbLanguage.Add("bengali")
  FMain.cmbLanguage.Add("bidi")
  FMain.cmbLanguage.Add("bosnian")
  FMain.cmbLanguage.Add("breton")
  FMain.cmbLanguage.Add("bulgarian")
  FMain.cmbLanguage.Add("catalan")
  FMain.cmbLanguage.Add("chinese")
  FMain.cmbLanguage.Add("churchslavonic")
  FMain.cmbLanguage.Add("coptic")
  FMain.cmbLanguage.Add("croatian")
  FMain.cmbLanguage.Add("czech")
  FMain.cmbLanguage.Add("danish")
  FMain.cmbLanguage.Add("divehi")
  FMain.cmbLanguage.Add("dutch")
  FMain.cmbLanguage.Add("esperanto")
  FMain.cmbLanguage.Add("estonian")
  FMain.cmbLanguage.Add("farsi")
  FMain.cmbLanguage.Add("finnish")
  FMain.cmbLanguage.Add("friulan")
  FMain.cmbLanguage.Add("galician")
  FMain.cmbLanguage.Add("georgian")
  FMain.cmbLanguage.Add("german")
  FMain.cmbLanguage.Add("greek")
  FMain.cmbLanguage.Add("hebrew")
  FMain.cmbLanguage.Add("hindi")
  FMain.cmbLanguage.Add("hungarian")
  FMain.cmbLanguage.Add("icelandic")
  FMain.cmbLanguage.Add("interlingua")
  FMain.cmbLanguage.Add("irish")
  FMain.cmbLanguage.Add("italian")
  FMain.cmbLanguage.Add("japanese")
  FMain.cmbLanguage.Add("kannada")
  FMain.cmbLanguage.Add("khmer")
  FMain.cmbLanguage.Add("korean")
  FMain.cmbLanguage.Add("kurdish")
  FMain.cmbLanguage.Add("lao")
  FMain.cmbLanguage.Add("latin")
  FMain.cmbLanguage.Add("latvian")
  FMain.cmbLanguage.Add("lithuanian")
  FMain.cmbLanguage.Add("lsorbian")
  FMain.cmbLanguage.Add("macedonian")
  FMain.cmbLanguage.Add("malayalam")
  FMain.cmbLanguage.Add("marathi")
  FMain.cmbLanguage.Add("nko")
  FMain.cmbLanguage.Add("norwegian")
  FMain.cmbLanguage.Add("nynorsk")
  FMain.cmbLanguage.Add("occitan")
  FMain.cmbLanguage.Add("piedmontese")
  FMain.cmbLanguage.Add("polish")
  FMain.cmbLanguage.Add("punjabi")
  FMain.cmbLanguage.Add("romanian")
  FMain.cmbLanguage.Add("romansh")
  FMain.cmbLanguage.Add("russian")
  FMain.cmbLanguage.Add("sami")
  FMain.cmbLanguage.Add("sanskrit")
  FMain.cmbLanguage.Add("scottish")
  FMain.cmbLanguage.Add("serbian")
  FMain.cmbLanguage.Add("slovak")
  FMain.cmbLanguage.Add("slovenian")
  FMain.cmbLanguage.Add("swedish")
  FMain.cmbLanguage.Add("syriac")
  FMain.cmbLanguage.Add("tamil")
  FMain.cmbLanguage.Add("telugu")
  FMain.cmbLanguage.Add("thai")
  FMain.cmbLanguage.Add("tibetan")
  FMain.cmbLanguage.Add("turkish")
  FMain.cmbLanguage.Add("turkmen")
  FMain.cmbLanguage.Add("ukrainian")
  FMain.cmbLanguage.Add("urdu")
  FMain.cmbLanguage.Add("usorbian")
  FMain.cmbLanguage.Add("vietnamese")
  FMain.cmbLanguage.Add("welsh")

  FMain.cmbOrigLanguage.Add("")
  FMain.cmbOrigLanguage.Add("spanish")
  FMain.cmbOrigLanguage.Add("portuguese")
  FMain.cmbOrigLanguage.Add("english")
  FMain.cmbOrigLanguage.Add("french")
  FMain.cmbOrigLanguage.Add("afrikaans")
  FMain.cmbOrigLanguage.Add("albanian")
  FMain.cmbOrigLanguage.Add("amharic")
  FMain.cmbOrigLanguage.Add("arabic")
  FMain.cmbOrigLanguage.Add("armenian")
  FMain.cmbOrigLanguage.Add("asturian")
  FMain.cmbOrigLanguage.Add("bahasai")
  FMain.cmbOrigLanguage.Add("bahasam")
  FMain.cmbOrigLanguage.Add("basque")
  FMain.cmbOrigLanguage.Add("bengali")
  FMain.cmbOrigLanguage.Add("bidi")
  FMain.cmbOrigLanguage.Add("bosnian")
  FMain.cmbOrigLanguage.Add("breton")
  FMain.cmbOrigLanguage.Add("bulgarian")
  FMain.cmbOrigLanguage.Add("catalan")
  FMain.cmbOrigLanguage.Add("chinese")
  FMain.cmbOrigLanguage.Add("churchslavonic")
  FMain.cmbOrigLanguage.Add("coptic")
  FMain.cmbOrigLanguage.Add("croatian")
  FMain.cmbOrigLanguage.Add("czech")
  FMain.cmbOrigLanguage.Add("danish")
  FMain.cmbOrigLanguage.Add("divehi")
  FMain.cmbOrigLanguage.Add("dutch")
  FMain.cmbOrigLanguage.Add("esperanto")
  FMain.cmbOrigLanguage.Add("estonian")
  FMain.cmbOrigLanguage.Add("farsi")
  FMain.cmbOrigLanguage.Add("finnish")
  FMain.cmbOrigLanguage.Add("friulan")
  FMain.cmbOrigLanguage.Add("galician")
  FMain.cmbOrigLanguage.Add("georgian")
  FMain.cmbOrigLanguage.Add("german")
  FMain.cmbOrigLanguage.Add("greek")
  FMain.cmbOrigLanguage.Add("hebrew")
  FMain.cmbOrigLanguage.Add("hindi")
  FMain.cmbOrigLanguage.Add("hungarian")
  FMain.cmbOrigLanguage.Add("icelandic")
  FMain.cmbOrigLanguage.Add("interlingua")
  FMain.cmbOrigLanguage.Add("irish")
  FMain.cmbOrigLanguage.Add("italian")
  FMain.cmbOrigLanguage.Add("japanese")
  FMain.cmbOrigLanguage.Add("kannada")
  FMain.cmbOrigLanguage.Add("khmer")
  FMain.cmbOrigLanguage.Add("korean")
  FMain.cmbOrigLanguage.Add("kurdish")
  FMain.cmbOrigLanguage.Add("lao")
  FMain.cmbOrigLanguage.Add("latin")
  FMain.cmbOrigLanguage.Add("latvian")
  FMain.cmbOrigLanguage.Add("lithuanian")
  FMain.cmbOrigLanguage.Add("lsorbian")
  FMain.cmbOrigLanguage.Add("macedonian")
  FMain.cmbOrigLanguage.Add("malayalam")
  FMain.cmbOrigLanguage.Add("marathi")
  FMain.cmbOrigLanguage.Add("nko")
  FMain.cmbOrigLanguage.Add("norwegian")
  FMain.cmbOrigLanguage.Add("nynorsk")
  FMain.cmbOrigLanguage.Add("occitan")
  FMain.cmbOrigLanguage.Add("piedmontese")
  FMain.cmbOrigLanguage.Add("polish")
  FMain.cmbOrigLanguage.Add("punjabi")
  FMain.cmbOrigLanguage.Add("romanian")
  FMain.cmbOrigLanguage.Add("romansh")
  FMain.cmbOrigLanguage.Add("russian")
  FMain.cmbOrigLanguage.Add("sami")
  FMain.cmbOrigLanguage.Add("sanskrit")
  FMain.cmbOrigLanguage.Add("scottish")
  FMain.cmbOrigLanguage.Add("serbian")
  FMain.cmbOrigLanguage.Add("slovak")
  FMain.cmbOrigLanguage.Add("slovenian")
  FMain.cmbOrigLanguage.Add("swedish")
  FMain.cmbOrigLanguage.Add("syriac")
  FMain.cmbOrigLanguage.Add("tamil")
  FMain.cmbOrigLanguage.Add("telugu")
  FMain.cmbOrigLanguage.Add("thai")
  FMain.cmbOrigLanguage.Add("tibetan")
  FMain.cmbOrigLanguage.Add("turkish")
  FMain.cmbOrigLanguage.Add("turkmen")
  FMain.cmbOrigLanguage.Add("ukrainian")
  FMain.cmbOrigLanguage.Add("urdu")
  FMain.cmbOrigLanguage.Add("usorbian")
  FMain.cmbOrigLanguage.Add("vietnamese")
  FMain.cmbOrigLanguage.Add("welsh")

  FMain.cmbLangId.Add("")
  FMain.cmbLangId.Add("spanish")
  FMain.cmbLangId.Add("portuguese")
  FMain.cmbLangId.Add("english")
  FMain.cmbLangId.Add("french")
  FMain.cmbLangId.Add("afrikaans")
  FMain.cmbLangId.Add("albanian")
  FMain.cmbLangId.Add("amharic")
  FMain.cmbLangId.Add("arabic")
  FMain.cmbLangId.Add("armenian")
  FMain.cmbLangId.Add("asturian")
  FMain.cmbLangId.Add("bahasai")
  FMain.cmbLangId.Add("bahasam")
  FMain.cmbLangId.Add("basque")
  FMain.cmbLangId.Add("bengali")
  FMain.cmbLangId.Add("bidi")
  FMain.cmbLangId.Add("bosnian")
  FMain.cmbLangId.Add("breton")
  FMain.cmbLangId.Add("bulgarian")
  FMain.cmbLangId.Add("catalan")
  FMain.cmbLangId.Add("chinese")
  FMain.cmbLangId.Add("churchslavonic")
  FMain.cmbLangId.Add("coptic")
  FMain.cmbLangId.Add("croatian")
  FMain.cmbLangId.Add("czech")
  FMain.cmbLangId.Add("danish")
  FMain.cmbLangId.Add("divehi")
  FMain.cmbLangId.Add("dutch")
  FMain.cmbLangId.Add("esperanto")
  FMain.cmbLangId.Add("estonian")
  FMain.cmbLangId.Add("farsi")
  FMain.cmbLangId.Add("finnish")
  FMain.cmbLangId.Add("friulan")
  FMain.cmbLangId.Add("galician")
  FMain.cmbLangId.Add("georgian")
  FMain.cmbLangId.Add("german")
  FMain.cmbLangId.Add("greek")
  FMain.cmbLangId.Add("hebrew")
  FMain.cmbLangId.Add("hindi")
  FMain.cmbLangId.Add("hungarian")
  FMain.cmbLangId.Add("icelandic")
  FMain.cmbLangId.Add("interlingua")
  FMain.cmbLangId.Add("irish")
  FMain.cmbLangId.Add("italian")
  FMain.cmbLangId.Add("japanese")
  FMain.cmbLangId.Add("kannada")
  FMain.cmbLangId.Add("khmer")
  FMain.cmbLangId.Add("korean")
  FMain.cmbLangId.Add("kurdish")
  FMain.cmbLangId.Add("lao")
  FMain.cmbLangId.Add("latin")
  FMain.cmbLangId.Add("latvian")
  FMain.cmbLangId.Add("lithuanian")
  FMain.cmbLangId.Add("lsorbian")
  FMain.cmbLangId.Add("macedonian")
  FMain.cmbLangId.Add("malayalam")
  FMain.cmbLangId.Add("marathi")
  FMain.cmbLangId.Add("nko")
  FMain.cmbLangId.Add("norwegian")
  FMain.cmbLangId.Add("nynorsk")
  FMain.cmbLangId.Add("occitan")
  FMain.cmbLangId.Add("piedmontese")
  FMain.cmbLangId.Add("polish")
  FMain.cmbLangId.Add("punjabi")
  FMain.cmbLangId.Add("romanian")
  FMain.cmbLangId.Add("romansh")
  FMain.cmbLangId.Add("russian")
  FMain.cmbLangId.Add("sami")
  FMain.cmbLangId.Add("sanskrit")
  FMain.cmbLangId.Add("scottish")
  FMain.cmbLangId.Add("serbian")
  FMain.cmbLangId.Add("slovak")
  FMain.cmbLangId.Add("slovenian")
  FMain.cmbLangId.Add("swedish")
  FMain.cmbLangId.Add("syriac")
  FMain.cmbLangId.Add("tamil")
  FMain.cmbLangId.Add("telugu")
  FMain.cmbLangId.Add("thai")
  FMain.cmbLangId.Add("tibetan")
  FMain.cmbLangId.Add("turkish")
  FMain.cmbLangId.Add("turkmen")
  FMain.cmbLangId.Add("ukrainian")
  FMain.cmbLangId.Add("urdu")
  FMain.cmbLangId.Add("usorbian")
  FMain.cmbLangId.Add("vietnamese")
  FMain.cmbLangId.Add("welsh")

  FMain.cmbTipoDeTesis.Add("")
  FMain.cmbTipoDeTesis.Add("tifthesis")
  FMain.cmbTipoDeTesis.Add("mathesis")
  FMain.cmbTipoDeTesis.Add("phdthesis")
  FMain.cmbTipoDeTesis.Add("candthesis")
  FMain.cmbTipoDeTesis.Add("ingenieriathesis")
  FMain.cmbTipoDeTesis.Add("magisterthesis")
  FMain.cmbTipoDeTesis.Add("gradothesis")
  FMain.cmbTipoDeTesis.Add("licenciaturathesis")
  FMain.cmbTipoDeTesis.Add("especialthesis")
  FMain.cmbTipoDeTesis.Add("posgradothesis")
  FMain.cmbTipoDeTesis.Add("profesoradothesis")

  FMain.cmbPagination.Add("")' lo dejo para compatibilidad con referencias viejas
  FMain.cmbPagination.Add("page")
  FMain.cmbPagination.Add("column")
  FMain.cmbPagination.Add("line")
  FMain.cmbPagination.Add("verse")
  FMain.cmbPagination.Add("section")
  FMain.cmbPagination.Add("paragraph")

  FMain.cmbBookPagination.Add("")' lo dejo para compatibilidad con referencias viejas
  FMain.cmbBookPagination.Add("page")
  FMain.cmbBookPagination.Add("column")
  FMain.cmbBookPagination.Add("line")
  FMain.cmbBookPagination.Add("verse")
  FMain.cmbBookPagination.Add("section")
  FMain.cmbBookPagination.Add("paragraph")

  FMain.CmbRelatedType.Add("")
  FMain.CmbRelatedType.Add("reprintof")
  FMain.CmbRelatedType.Add("translationof")
  FMain.CmbRelatedType.Add("translatedas")
  FMain.CmbRelatedType.Add("multivolume")

  FMain.cmbPubState.Add("")
  FMain.cmbPubState.Add("mimeograph")
  FMain.cmbPubState.Add("photocopy")
  FMain.cmbPubState.Add("digitalprinting")
  FMain.cmbPubState.Add("inpreparation")
  FMain.cmbPubState.Add("submitted")
  FMain.cmbPubState.Add("forthcoming")
  FMain.cmbPubState.Add("inpress")
  FMain.cmbPubState.Add("prepublished")
  FMain.cmbPubState.Add("edauthor")

  FMain.cmbEditorType.Add("")
  FMain.cmbEditorType.Add("editor")
  FMain.cmbEditorType.Add("compiler")
  FMain.cmbEditorType.Add("direction")
  FMain.cmbEditorType.Add("founder")
  FMain.cmbEditorType.Add("continuator")
  FMain.cmbEditorType.Add("redactor")
  FMain.cmbEditorType.Add("reviser")
  FMain.cmbEditorType.Add("collaborator")
  FMain.cmbEditorType.Add("cordinator")
  FMain.cmbEditorType.Add("organizator")

  FMain.cmbEditorTypeA.Add("")
  FMain.cmbEditorTypeA.Add("editor")
  FMain.cmbEditorTypeA.Add("compiler")
  FMain.cmbEditorTypeA.Add("direction")
  FMain.cmbEditorTypeA.Add("founder")
  FMain.cmbEditorTypeA.Add("continuator")
  FMain.cmbEditorTypeA.Add("redactor")
  FMain.cmbEditorTypeA.Add("reviser")
  FMain.cmbEditorTypeA.Add("collaborator")
  FMain.cmbEditorTypeA.Add("cordinator")
  FMain.cmbEditorTypeA.Add("organizator")

  FMain.cmbEditorTypeB.Add("")
  FMain.cmbEditorTypeB.Add("editor")
  FMain.cmbEditorTypeB.Add("compiler")
  FMain.cmbEditorTypeB.Add("direction")
  FMain.cmbEditorTypeB.Add("founder")
  FMain.cmbEditorTypeB.Add("continuator")
  FMain.cmbEditorTypeB.Add("redactor")
  FMain.cmbEditorTypeB.Add("reviser")
  FMain.cmbEditorTypeB.Add("collaborator")
  FMain.cmbEditorTypeB.Add("cordinator")
  FMain.cmbEditorTypeB.Add("organizator")

  FMain.cmbEditorTypeC.Add("")
  FMain.cmbEditorTypeC.Add("editor")
  FMain.cmbEditorTypeC.Add("compiler")
  FMain.cmbEditorTypeC.Add("direction")
  FMain.cmbEditorTypeC.Add("founder")
  FMain.cmbEditorTypeC.Add("continuator")
  FMain.cmbEditorTypeC.Add("redactor")
  FMain.cmbEditorTypeC.Add("reviser")
  FMain.cmbEditorTypeC.Add("collaborator")
  FMain.cmbEditorTypeC.Add("cordinator")
  FMain.cmbEditorTypeC.Add("organizator")

  FMain.cmbEprintType.Add("")
  FMain.cmbEprintType.Add("arXiv")
  FMain.cmbEprintType.Add("PubMed")
  FMain.cmbEprintType.Add("JSTOR")
  FMain.cmbEprintType.Add("Handle System (HDL)")
  FMain.cmbEprintType.Add("URL")
  FMain.cmbEprintType.Add("DOI")

End

Public Sub LimpiarCamposBIB()

  ' FMain.idBibtex.Text = ""
  ' FMain.idProyectoBibtex.Text = ""
  FMain.txtAuthor.Text = ""
  FMain.txtTitle.Text = ""
  FMain.cmbTipoCSL.Clear
  FMain.txtClaveBibtex.Text = ""
  FMain.cmbTipoDeEntrada.Clear
  FMain.txtNameAddOn.Text = ""
  FMain.txtBookAuthor.Text = ""
  FMain.txtEditor.Text = ""
  FMain.txtEditorA.Text = ""
  FMain.txtEditorB.Text = ""
  FMain.txtEditorC.Text = ""
  FMain.txtAfterword.Text = ""
  FMain.txtForeword.Text = ""
  FMain.txtCommentator.Text = ""
  FMain.txtIntroduction.Text = ""
  FMain.txtTranslator.Text = ""
  FMain.txtAnnotator.Text = ""
  FMain.txtHolder.Text = ""
  FMain.txtGender.Text = ""
  FMain.txtShortAuthor.Text = ""
  FMain.cmbEditorType.Clear
  FMain.cmbEditorTypeA.Clear
  FMain.cmbEditorTypeB.Clear
  FMain.cmbEditorTypeC.Clear
  FMain.txtTitleAddOn.Text = ""
  FMain.txtSubTitle.Text = ""
  FMain.txtSeries.Text = ""
  FMain.txtBookTitle.Text = ""
  FMain.txtBookTitleAddOn.Text = ""
  FMain.txtMainTitle.Text = ""
  FMain.txtMainTitleAddOn.Text = ""
  FMain.txtJournalTitle.Text = ""
  FMain.txtJournalTitleAddOn.Text = ""
  FMain.txtIssueTitle.Text = ""
  FMain.txtIssueTitleAddOn.Text = ""
  FMain.txtEventTitle.Text = ""
  FMain.txtEventTitleAddOn.Text = ""
  FMain.txtIndexTitle.Text = ""
  FMain.txtShortTitle.Text = ""
  FMain.txtReprintTitle.Text = ""
  FMain.txtVolume.Text = ""
  FMain.txtVolumes.Text = ""
  FMain.txtNumber.Text = ""
  FMain.txtChapter.Text = ""
  FMain.txtEid.Text = ""
  FMain.txtPart.Text = ""
  FMain.txtEdition.Text = ""
  FMain.txtIssue.Text = ""
  FMain.txtYear.Text = ""
  FMain.txtEventDate.Text = ""
  FMain.txtDate.Text = ""
  FMain.txtOrigDate.Text = ""
  FMain.txtUrlDate.Text = ""
  FMain.txtVersion.Text = ""
  FMain.cmbHyphenation.Clear
  FMain.cmbLanguage.Clear
  FMain.cmbOrigLanguage.Clear
  FMain.cmbLangId.Clear
  FMain.txtLandIdOpts.Text = ""
  FMain.cmbPubState.Clear
  FMain.txtPages.Text = ""
  FMain.txtPageTotal.Text = ""
  FMain.cmbPagination.Clear
  FMain.cmbBookPagination.Clear
  FMain.txtLocation.Text = ""
  FMain.txtOrigLocation.Text = ""
  FMain.txtInstitution.Text = ""
  FMain.txtOrganization.Text = ""
  FMain.txtPublisher.Text = ""
  FMain.txtOrigPublisher.Text = ""
  FMain.txtVenue.Text = ""
  FMain.txtEprint.Text = ""
  FMain.cmbEprintType.Clear
  FMain.txtUrl.Text = ""
  FMain.txtIsbn.Text = ""
  FMain.txtIssn.Text = ""
  FMain.txtIsmn.Text = ""
  FMain.txtIsrn.Text = ""
  FMain.txtIsan.Text = ""
  FMain.txtIswc.Text = ""
  FMain.txtDoi.Text = ""
  FMain.cmbRelatedType.Clear
  FMain.txtRelated.Text = ""
  FMain.txtRelatedString.Text = ""
  FMain.txtAddendum.Text = ""
  FMain.txtEntrySubType.Text = ""
  FMain.txtOptions.Text = ""
  FMain.txtLabel.Text = ""
  FMain.txtHowPublished.Text = ""
  FMain.txtShortHand.Text = ""
  FMain.txtShortHandIntro.Text = ""
  FMain.txtIds.Text = ""
  FMain.txtEntrySet.Text = ""
  FMain.txtCrossRef.Text = ""
  FMain.txtXref.Text = ""
  FMain.txtXdata.Text = ""
  FMain.txtPreSort.Text = ""
  FMain.txtSortKey.Text = ""
  FMain.txtSortName.Text = ""
  FMain.txtSortHand.Text = ""
  FMain.txtSortYear.Text = ""
  FMain.txtSortTitle.Text = ""
  FMain.txtIndexSortTitle.Text = ""
  FMain.txtAbstract.Text = ""
  FMain.txtNote.Text = ""
  FMain.txtLibrary.Text = ""
  FMain.txtAnnotation.Text = ""
  FMain.txtFile.Text = ""

End

Public Sub MostrarRefereciasEnTableViewBibtexEnCurso(iRow As Integer)

  With FMain
    .idBibtex.Text = .gvReferenciasEnCurso[iRow, 0].Text
    .idProyectoBibtex.Text = .gvReferenciasEnCurso[iRow, 1].Text
    .txtAuthor.Text = .gvReferenciasEnCurso[iRow, 2].Text
    .txtTitle.Text = .gvReferenciasEnCurso[iRow, 3].Text
    .cmbTipoCSL.Text = .gvReferenciasEnCurso[iRow, 4].Text
    .txtClaveBibtex.Text = .gvReferenciasEnCurso[iRow, 5].Text
    .cmbTipoDeEntrada.Text = .gvReferenciasEnCurso[iRow, 6].Text
    .txtNameAddOn.Text = .gvReferenciasEnCurso[iRow, 7].Text
    .txtBookAuthor.Text = .gvReferenciasEnCurso[iRow, 8].Text
    .txtEditor.Text = .gvReferenciasEnCurso[iRow, 9].Text
    .txtEditorA.Text = .gvReferenciasEnCurso[iRow, 10].Text
    .txtEditorB.Text = .gvReferenciasEnCurso[iRow, 11].Text
    .txtEditorC.Text = .gvReferenciasEnCurso[iRow, 12].Text
    .txtAfterword.Text = .gvReferenciasEnCurso[iRow, 13].Text
    .txtForeword.Text = .gvReferenciasEnCurso[iRow, 14].Text
    .txtCommentator.Text = .gvReferenciasEnCurso[iRow, 15].Text
    .txtIntroduction.Text = .gvReferenciasEnCurso[iRow, 16].Text
    .txtTranslator.Text = .gvReferenciasEnCurso[iRow, 17].Text
    .txtAnnotator.Text = .gvReferenciasEnCurso[iRow, 18].Text
    .txtHolder.Text = .gvReferenciasEnCurso[iRow, 19].Text
    .txtGender.Text = .gvReferenciasEnCurso[iRow, 20].Text
    .txtShortAuthor.Text = .gvReferenciasEnCurso[iRow, 21].Text
    .cmbEditorType.Text = .gvReferenciasEnCurso[iRow, 22].Text
    .cmbEditorTypeA.Text = .gvReferenciasEnCurso[iRow, 23].Text
    .cmbEditorTypeB.Text = .gvReferenciasEnCurso[iRow, 24].Text
    .cmbEditorTypeC.Text = .gvReferenciasEnCurso[iRow, 25].Text
    .txtTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 26].Text
    .txtSubTitle.Text = .gvReferenciasEnCurso[iRow, 27].Text
    .txtSeries.Text = .gvReferenciasEnCurso[iRow, 28].Text
    .txtBookTitle.Text = .gvReferenciasEnCurso[iRow, 29].Text
    .txtBookTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 30].Text
    .txtMainTitle.Text = .gvReferenciasEnCurso[iRow, 31].Text
    .txtMainTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 32].Text
    .txtJournalTitle.Text = .gvReferenciasEnCurso[iRow, 33].Text
    .txtJournalTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 34].Text
    .txtIssueTitle.Text = .gvReferenciasEnCurso[iRow, 35].Text
    .txtIssueTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 36].Text
    .txtEventTitle.Text = .gvReferenciasEnCurso[iRow, 37].Text
    .txtEventTitleAddOn.Text = .gvReferenciasEnCurso[iRow, 38].Text
    .txtIndexTitle.Text = .gvReferenciasEnCurso[iRow, 39].Text
    .txtShortTitle.Text = .gvReferenciasEnCurso[iRow, 40].Text
    .txtReprintTitle.Text = .gvReferenciasEnCurso[iRow, 41].Text
    .txtVolume.Text = .gvReferenciasEnCurso[iRow, 42].Text
    .txtVolumes.Text = .gvReferenciasEnCurso[iRow, 43].Text
    .txtNumber.Text = .gvReferenciasEnCurso[iRow, 44].Text
    .txtChapter.Text = .gvReferenciasEnCurso[iRow, 45].Text
    .txtEid.Text = .gvReferenciasEnCurso[iRow, 46].Text
    .txtPart.Text = .gvReferenciasEnCurso[iRow, 47].Text
    .txtEdition.Text = .gvReferenciasEnCurso[iRow, 48].Text
    .txtIssue.Text = .gvReferenciasEnCurso[iRow, 49].Text
    .txtYear.Text = .gvReferenciasEnCurso[iRow, 50].Text
    .txtEventDate.Text = .gvReferenciasEnCurso[iRow, 51].Text
    .txtDate.Text = .gvReferenciasEnCurso[iRow, 52].Text
    .txtOrigDate.Text = .gvReferenciasEnCurso[iRow, 53].Text
    .txtUrlDate.Text = .gvReferenciasEnCurso[iRow, 54].Text
    .txtVersion.Text = .gvReferenciasEnCurso[iRow, 55].Text
    .cmbHyphenation.Text = .gvReferenciasEnCurso[iRow, 56].Text
    .cmbLanguage.Text = .gvReferenciasEnCurso[iRow, 57].Text
    .cmbOrigLanguage.Text = .gvReferenciasEnCurso[iRow, 58].Text
    .cmbLangId.Text = .gvReferenciasEnCurso[iRow, 59].Text
    .txtLandIdOpts.Text = .gvReferenciasEnCurso[iRow, 60].Text
    .cmbPubState.Text = .gvReferenciasEnCurso[iRow, 61].Text
    .txtPages.Text = .gvReferenciasEnCurso[iRow, 62].Text
    .txtPageTotal.Text = .gvReferenciasEnCurso[iRow, 63].Text
    .cmbPagination.Text = .gvReferenciasEnCurso[iRow, 64].Text
    .cmbBookPagination.Text = .gvReferenciasEnCurso[iRow, 65].Text
    .txtLocation.Text = .gvReferenciasEnCurso[iRow, 66].Text
    .txtOrigLocation.Text = .gvReferenciasEnCurso[iRow, 67].Text
    .txtInstitution.Text = .gvReferenciasEnCurso[iRow, 68].Text
    .txtOrganization.Text = .gvReferenciasEnCurso[iRow, 69].Text
    .txtPublisher.Text = .gvReferenciasEnCurso[iRow, 70].Text
    .txtOrigPublisher.Text = .gvReferenciasEnCurso[iRow, 71].Text
    .txtVenue.Text = .gvReferenciasEnCurso[iRow, 72].Text
    .txtEprint.Text = .gvReferenciasEnCurso[iRow, 73].Text
    .cmbEprintType.Text = .gvReferenciasEnCurso[iRow, 74].Text
    .txtUrl.Text = .gvReferenciasEnCurso[iRow, 75].Text
    .txtIsbn.Text = .gvReferenciasEnCurso[iRow, 76].Text
    .txtIssn.Text = .gvReferenciasEnCurso[iRow, 77].Text
    .txtIsmn.Text = .gvReferenciasEnCurso[iRow, 78].Text
    .txtIsrn.Text = .gvReferenciasEnCurso[iRow, 79].Text
    .txtIsan.Text = .gvReferenciasEnCurso[iRow, 80].Text
    .txtIswc.Text = .gvReferenciasEnCurso[iRow, 81].Text
    .txtDoi.Text = .gvReferenciasEnCurso[iRow, 82].Text
    .cmbRelatedType.Text = .gvReferenciasEnCurso[iRow, 83].Text
    .txtRelated.Text = .gvReferenciasEnCurso[iRow, 84].Text
    .txtRelatedString.Text = .gvReferenciasEnCurso[iRow, 85].Text
    .txtAddendum.Text = .gvReferenciasEnCurso[iRow, 86].Text
    .txtEntrySubType.Text = .gvReferenciasEnCurso[iRow, 87].Text
    .txtOptions.Text = .gvReferenciasEnCurso[iRow, 88].Text
    .txtLabel.Text = .gvReferenciasEnCurso[iRow, 89].Text
    .txtHowPublished.Text = .gvReferenciasEnCurso[iRow, 90].Text
    .txtShortHand.Text = .gvReferenciasEnCurso[iRow, 91].Text
    .txtShortHandIntro.Text = .gvReferenciasEnCurso[iRow, 92].Text
    .txtIds.Text = .gvReferenciasEnCurso[iRow, 93].Text
    .txtEntrySet.Text = .gvReferenciasEnCurso[iRow, 94].Text
    .txtCrossRef.Text = .gvReferenciasEnCurso[iRow, 95].Text
    .txtXref.Text = .gvReferenciasEnCurso[iRow, 96].Text
    .txtXdata.Text = .gvReferenciasEnCurso[iRow, 97].Text
    .txtPreSort.Text = .gvReferenciasEnCurso[iRow, 98].Text
    .txtSortKey.Text = .gvReferenciasEnCurso[iRow, 99].Text
    .txtSortName.Text = .gvReferenciasEnCurso[iRow, 100].Text
    .txtSortHand.Text = .gvReferenciasEnCurso[iRow, 101].Text
    .txtSortYear.Text = .gvReferenciasEnCurso[iRow, 102].Text
    .txtSortTitle.Text = .gvReferenciasEnCurso[iRow, 103].Text
    .txtIndexSortTitle.Text = .gvReferenciasEnCurso[iRow, 104].Text
    .txtAbstract.Text = .gvReferenciasEnCurso[iRow, 105].Text
    .txtNote.Text = .gvReferenciasEnCurso[iRow, 106].Text
    .txtLibrary.Text = .gvReferenciasEnCurso[iRow, 107].Text
    .txtAnnotation.Text = .gvReferenciasEnCurso[iRow, 108].Text
    .txtFile.Text = .gvReferenciasEnCurso[iRow, 109].Text
  End With

End
