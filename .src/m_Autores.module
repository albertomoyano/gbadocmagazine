' Gambas module file

Private ContenidoAut As Result
' Private ArticulosIDs As Collection

Public Sub ObtenerIdNuevoAutor()

  If FMain.ComboBoxArticuloAsociado.Text = "" Then
    Message.Info("No hay artículos disponibles para asignar autores.")
    Return
  Endif

  Dim Idn As Integer
  Dim MaxId As Variant

  MaxId = m_OnOff_y_Red.meConn.Exec("SELECT MAX(id) FROM autores LIMIT 1")

  If MaxId["MAX(id)"] = Null Then
    Idn = 0
  Else
    Idn = CInt(MaxId["MAX(id)"]) + 1
  Endif

  FMain.idAutor.Text = Idn

End

Public Sub ConfigurarTableViewAutores(grid As GridView)

  With grid
    .Header = True
    .Grid = True
    .Columns.Count = 12

    ' Configuración de columnas
    For i As Integer = 0 To 11
      Select Case i
        Case 5
          .Columns[i].Title = "Nombre normalizado"
          .Columns[i].Width = 900
        Case Else
          .Columns[i].Title = ""
          .Columns[i].Width = 0
      End Select
    Next
  End With

End

Public Sub RefrescarTableViewAAutores()

  FMain.gbMetadatosAutores.Clear
  ContenidoAut = m_OnOff_y_Red.meConn.Exec("SELECT * FROM autores")'
  FMain.gbMetadatosAutores.Rows.Count = ContenidoAut.Count

End
